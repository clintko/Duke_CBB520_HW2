{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Download SRA Data: SRR4841864"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Information of the data \n",
    "- Title: Saccharomyces cerevisiae YJF153 paired-end Illumina WGS\n",
    "    - Abstract: Saccharomyces cerevisiae YJF153 (derivative of oak strain YPS163) whole genome sequence\n",
    "    - Alias: run_1008_s_1_3_withindex_sequence.txt_GAGTACG.YJF153.fq.gz\n",
    "- Study: SRP092474\n",
    "- Experiment: SRX2321838\n",
    "    - Name: YJF153\n",
    "    - Strategy: WGS\n",
    "    - Source: GENOMIC\n",
    "    - Selection: RANDOM\n",
    "    - Layout: PAIRED\n",
    "    - Instrument Model: Illumina HiSeq 2500\n",
    "- Reference:\n",
    "    - [DRASearch: SRR4841864](https://trace.ddbj.nig.ac.jp/DRASearch/run?acc=SRR4841864)\n",
    "    - [NCBI: SRR4841864-SRA browser](https://trace.ncbi.nlm.nih.gov/Traces/sra/?run=SRR4841864)\n",
    "    - [NCBI: SRR4841864-BioProject](https://www.ncbi.nlm.nih.gov//bioproject/352256)\n",
    "    - [NCBI: SRR4841864-BioSample](https://www.ncbi.nlm.nih.gov/biosample/SAMN05968761)\n",
    "    - [NCBI: SRR4841864-Experiment](https://www.ncbi.nlm.nih.gov/sra/SRR4841864/)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "source config.sh"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/home/jovyan/work/Data/SRR4841864/rawdata\n"
     ]
    }
   ],
   "source": [
    "echo $RAW_FASTQS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "SRR4841864.sra\n"
     ]
    }
   ],
   "source": [
    "ls $RAW_FASTQS/SRR4841864"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Fetch the SRA data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "2019-10-08T23:13:41 prefetch.2.10.0: KClientHttpOpen - connected from '172.17.0.5' to trace.ncbi.nlm.nih.gov (130.14.29.113) \n",
      "2019-10-08T23:13:41 prefetch.2.10.0: KClientHttpOpen - verifying CA cert \n",
      "2019-10-08T23:13:49 prefetch.2.10.0: KClientHttpOpen - connected from '172.17.0.5' to sra-download.ncbi.nlm.nih.gov (130.14.250.26) \n",
      "2019-10-08T23:13:49 prefetch.2.10.0: KClientHttpOpen - verifying CA cert \n",
      "2019-10-08T23:13:49 prefetch.2.10.0: 1) Downloading 'SRR4841864'...\n",
      "2019-10-08T23:13:49 prefetch.2.10.0:  Downloading via https...\n",
      "2019-10-08T23:13:49 prefetch.2.10.0: https://sra-download.ncbi.nlm.nih.gov/traces/sra7/SRR/004728/SRR4841864 -> /home/jovyan/work/Data/SRR4841864/rawdata/SRR4841864/SRR4841864.sra.tmp.11178.tmp\n",
      "2019-10-08T23:13:49 prefetch.2.10.0: KClientHttpOpen - connected from '172.17.0.5' to sra-download.ncbi.nlm.nih.gov (130.14.250.25) \n",
      "2019-10-08T23:13:49 prefetch.2.10.0: KClientHttpOpen - verifying CA cert \n",
      "2019-10-08T23:14:15 prefetch.2.10.0: /home/jovyan/work/Data/SRR4841864/rawdata/SRR4841864/SRR4841864.sra.tmp.11178.tmp (740953041)\n",
      "2019-10-08T23:14:15 prefetch.2.10.0:  https download succeed\n",
      "2019-10-08T23:14:15 prefetch.2.10.0: 1) 'SRR4841864' was downloaded successfully\n",
      "2019-10-08T23:14:15 prefetch.2.10.0: 'SRR4841864' has 0 unresolved dependencies\n"
     ]
    }
   ],
   "source": [
    "prefetch -v SRR4841864 -O $RAW_FASTQS"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Set the directories for my analysis"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "mv $RAW_FASTQS/SRR4841864/SRR4841864.sra $RAW_FASTQS/SRR4841864.sra"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "rm -rf $RAW_FASTQS/SRR4841864"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Split the paired-end data into read 1 and read 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Read 5391722 spots for /home/jovyan/work/Data/SRR4841864/rawdata/SRR4841864.sra\n",
      "Written 5391722 spots for /home/jovyan/work/Data/SRR4841864/rawdata/SRR4841864.sra\n"
     ]
    }
   ],
   "source": [
    "fastq-dump --split-files $RAW_FASTQS/SRR4841864.sra -O $RAW_FASTQS"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Check the files & directory**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "SRR4841864_1.fastq  SRR4841864_2.fastq  SRR4841864.sra\n"
     ]
    }
   ],
   "source": [
    "ls $RAW_FASTQS"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Bash",
   "language": "bash",
   "name": "bash"
  },
  "language_info": {
   "codemirror_mode": "shell",
   "file_extension": ".sh",
   "mimetype": "text/x-sh",
   "name": "bash"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
